# PWA (Progressive Web App) — Shaping Notes

## Problem Statement

Users access the platform primarily from desktop browsers. A PWA enables mobile installation, offline access, and push notifications — improving engagement especially for users who want quick request submissions or status checks.

## Key Decisions

### 1. PWA Scope
- **Decision**: Full PWA with install prompt + offline fallback
  - `manifest.json` for install metadata
  - Service worker for caching and offline support
  - Offline page when network unavailable
  - Add-to-homescreen on mobile and desktop

### 2. Build Tooling
- **Decision**: Vite PWA plugin (`vite-plugin-pwa`)
- Auto-generates service worker (Workbox under the hood)
- Handles manifest generation
- Cache strategies configurable per route/asset type
- Minimal config, integrates with existing Vite setup

### 3. Caching Strategy
- **Decision**: Network-first for API, cache-first for static assets
  - **Static assets** (JS, CSS, images): Cache-first with background update
  - **API responses**: Network-first with stale fallback
  - **HTML pages**: Network-first (SPA, so mainly index.html)
  - Offline fallback page when completely disconnected

### 4. Offline Experience
- **Decision**: Read-only offline with clear messaging
  - Show cached data when offline (previously loaded requests)
  - Disable forms and actions (vote, comment, submit)
  - Clear "You're offline" banner
  - No offline queue/sync (too complex for now)

### 5. Push Notifications
- **Decision**: Future, ties into Notifications system (F8)
  - Web Push API integration
  - Requires VAPID keys and push subscription management
  - Only implement after F8 notification system exists
  - Optional opt-in during install/first visit

### 6. App Metadata
- **Decision**: Branded PWA experience
  - App name: "Business Requests"
  - Short name: "Requests"
  - Theme color: matches current accent color
  - Icons: multiple sizes (192x192, 512x512)
  - Display: standalone (no browser chrome)
  - Start URL: `/`

## Files to Change

### Client
- `client/vite.config.js` — Add `vite-plugin-pwa` config
- `client/public/manifest.json` — PWA manifest (or generated by plugin)
- `client/public/icons/` — App icons in required sizes
- `client/src/offline.html` — Offline fallback page
- `client/src/components/layout/Header.jsx` — Offline indicator banner
- `client/src/App.jsx` — Register service worker, detect online/offline

### Dependencies (npm)
- `vite-plugin-pwa` — Vite PWA integration
- `workbox-*` — Service worker runtime (bundled with plugin)

## No Server Changes Required

PWA is entirely client-side. Push notifications (future) would need server endpoints.

## Dependencies

None (push notifications tie into F8 later)

## Effort Estimate

Medium — Plugin setup, manifest config, offline page, icons, testing across devices
